#!/bin/env cmsRun

process impactParameter = {

    service = AdaptorConfig {}

    # input file
    source = PoolSource {
        untracked vstring fileNames = {
	  "rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/0ECDACDD-5396-DB11-973B-00C09FD949C0.root"
	}

        untracked int32 maxEvents = 10
    }

    module out = PoolOutputModule {
        untracked string fileName = 'taujets.root'
        untracked vstring outputCommands = {
            "drop *",
            "keep *_jetTracksAssociator_*_*",
            "keep *_coneIsolation_*_*",
            "keep *_*_*_impactParameter",
            "keep *_associator_*_*",
            "keep *_iterativeCone5CaloJets_*_*",
            "keep *_ctfWithMaterialTracks_*_*",
            "keep *_*_*_h",
            "keep *_VtxSmeared_*_*",
            "keep *_source_*_*"
        }
    }


    # Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "INFO"
    # Magnetic Field
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

    include "TrackingTools/TransientTrack/data/TransientTrackBuilder.cfi"

    # Test tracks to jets association
    module jetTrackAssociations = JetTracksAssociator {
        InputTag tracks = ctfWithMaterialTracks
        InputTag jets   = iterativeCone5CaloJets
        double coneSize = 0.5
    }

   module coneIsolation = ConeIsolation {
        string JetTrackSrc = "jetTracksAssociator"
        string vertexSrc = "pixelVertices"
        int32 MinimumNumberOfPixelHits = 1
        int32 MinimumNumberOfHits = 8
        double MaximumTransverseImpactParameter = 300.
        double MinimumTransverseMomentum = 1.
        double MaximumChiSquared = 1000
        double MatchingCone = 0.1
        double  SignalCone = 0.07
        double  IsolationCone = 0.45
        double MinimumTransverseMomentumInIsolationRing = 0.
        double MinimumTransverseMomentumLeadingTrack = 6.
        double DeltaZetTrackVertex = 15.
        int32   MaximumNumberOfTracksIsolationRing = 0.
        bool useVertex = false
    }

    module impactParameter = ImpactParameter {
        string JetTagProd = "coneIsolation"
        double TauImpactParameterMin = -9999
        double TauImpactParameterMax =  9999
        double TauImpactParameterSignificanceMin = -9999
        bool   UseTauImpactParameterSign = false
        bool   UseTau3DImpactParameter = false
        string vertexSrc = "pixelVertices"
        bool useVertex = false
    }

    # module execution
    path p = {jetTrackAssociations, coneIsolation, impactParameter}
    endpath outpath = { out }
}

